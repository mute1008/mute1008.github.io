<!DOCTYPE html>
<html lang="en-us">
    
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="theme-color" content="dark">
    <title>ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„ | mute1997.github.io</title>

    
    
    
    <meta property="og:site_name" content="" />
    <meta property="og:title" content="ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„ | mute1997.github.io"/>
    <meta itemprop="name" content="ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„ | mute1997.github.io" />
    <meta name="twitter:title" content="ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„ | mute1997.github.io" />
    <meta name="application-name" content="ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„ | mute1997.github.io" /><meta name="twitter:card" content="summary"/>

    <meta name="description" content="" />
    <meta name="twitter:description" content=""/>
    <meta itemprop="description" content=""/>
    <meta property="og:description" content="" />

    

<meta property="og:type" content="article" />
<meta property="article:publisher" content="" />
<meta property="og:article:published_time" content=2020-11-07T00:00:00Z />
<meta property="article:published_time" content=2020-11-07T00:00:00Z />





<script defer type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„",
    "author": {
      "@type": "Person",
      "name": ""
    },
    "datePublished": "2020-11-07",
    "description": "",
    "wordCount":  129 ,
    "mainEntityOfPage": "True",
    "dateModified": "2020-11-07",
    "publisher": {
      "@type": "Organization",
      "name": "",
      "logo": {
        "@type": "imageObject",
        "url": "https:\/\/mute1997.github.io\/favicon.ico"
      }
    }
  }
</script>



    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    
    <link rel="stylesheet" href="/sass/main.min.ab99ff095f832511e24ffb2fba2b51ad473b2f7e9301d674eba2c6c3a6e8bd81.css">
    
</head>
    
    <script>
        (function() {
            const colorSchemeKey = 'ThemeColorScheme';
            localStorage.setItem(colorSchemeKey, "dark");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'ThemeColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.userColorScheme = 'dark';
        } else {
            document.documentElement.dataset.userColorScheme = 'light';
        }
    })();
</script>


    <body class="dark">
        <nav class="navbar">
    <div class="container">
        <div class="flex">
            <div>
                <a class="brand" href="/">
                    
                    <span class="emoji">
                        ğŸ˜
                    </span>
                    
                    
                    mute1997.github.io
                    </a>
            </div>
            <div class="flex">
                
                <a href="/articles/">Articles</a>
                
                
            </div>
            </div>
    </div>
</nav>

        <main>
            
<div class="container">
    <article>
        <header class="article-header">
            <div class="thumb">
                <div>
                    <h1>ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®å®Ÿä½“å‚ç…§ã®æ‰±ã„</h1>
                    <div class="post-meta">
                        <div>
                            
                            
                              
                            
                            By  | <time>November 07, 2020</time>
                            | 1 minutes
                        </div>
                        <div class="tags">
                            
                            <a href="/tags/security/">security</a>
                            
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </article>

    <div class="article-post">
    <p>ä»¥ä¸‹ã®è¨˜äº‹ã‚’èª­ã‚“ã§ã„ã¦æ°—ã«ãªã£ãŸã“ã¨ãŒã‚ã‚‹ã®ã§èª¿ã¹ã¦ã¿ãŸã€‚</p>
<p><a href="https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output">https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output</a></p>
<p>æ°—ã«ãªã£ãŸã®ã¯ä»¥ä¸‹ã®éƒ¨åˆ†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">Sometimes you&#39;ll need to apply multiple layers of encoding, in the correct order. For example, to safely embed user input inside an event handler, you need to deal with both the JavaScript context and the HTML context. So you need to first Unicode-escape the input, and then HTML-encode it:

&lt;a href=&#34;#&#34; onclick=&#34;x=&#39;This string needs two layers of escaping&#39;&#34;&gt;test&lt;/a&gt;
</code></pre></td></tr></table>
</div>
</div><p>ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«JavaScriptã‚’æ›¸ã„ã¦ã„ã‚‹æ‰€ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‚’åŸ‹ã‚è¾¼ã‚€å ´åˆã¯ã€unicodeã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’ã—ã¦ã‹ã‚‰HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨æ›¸ã„ã¦ã‚ã‚‹ã€‚</p>
<p>å€‹äººçš„ã«ã¯unicodeã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã ã‘ã§ã¯ãƒ€ãƒ¡ãªã®ã‹æ°—ã«ãªã£ãŸã®ã§å®Ÿé¨“ã—ã¦ã¿ãŸã€‚</p>
<p>ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«<code>';alert(1);'</code>ã‚’å…¥åŠ›ã—ãŸã“ã¨ã‚’è€ƒãˆã‚‹ã€‚</p>
<p>ä»¥ä¸‹ãŒunicodeã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã®ã¿ã‚’è¡Œã£ã¦åŸ‹ã‚è¾¼ã‚“ã å ´åˆã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;#&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;x=&#39;&amp;#x0027;&amp;#x003b;alert&amp;#x0028;1&amp;#x0029;&amp;#x003b;&amp;#x0027;&#39;;&#34;</span><span class="p">&gt;</span>link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»¥ä¸‹ã¯unicodeã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ãŸå¾Œã«HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’è¡Œã£ãŸã‚‚ã®ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;#&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;x=&#39;&amp;#38;&amp;#35;x0027&amp;#59;&amp;#38;&amp;#35;x003b&amp;#59;alert&amp;#38;&amp;#35;x0028&amp;#59;1&amp;#38;&amp;#35;x0029&amp;#59;&amp;#38;&amp;#35;x003b&amp;#59;&amp;#38;&amp;#35;x0027&amp;#59;&#39;;&#34;</span><span class="p">&gt;</span>link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>unicodeã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã¨HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã¯ä»¥ä¸‹ã®é–¢æ•°ã‚’ç”¨ã„ãŸã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">htmlEncode</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
  <span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^\w. ]/gi</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span>
     <span class="k">return</span> <span class="s1">&#39;&amp;#&#39;</span><span class="o">+</span><span class="nx">c</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;;&#39;</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">jsEscape</span><span class="p">(</span><span class="nx">str</span><span class="p">){</span>
  <span class="k">return</span> <span class="nb">String</span><span class="p">(</span><span class="nx">str</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^\w. ]/gi</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">){</span>
     <span class="k">return</span> <span class="s1">&#39;&amp;#x&#39;</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;0000&#39;</span><span class="o">+</span><span class="nx">c</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;;&#39;</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ã“ã‚Œã‚‰ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ã‹ã‚‰ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å‰è€…ã¯ã‚¢ãƒ©ãƒ¼ãƒˆãŒå®Ÿè¡Œã•ã‚Œã€å¾Œè€…ã¯ä½•ã‚‚èµ·ã“ã‚‰ãªã„ã€‚</p>
<p>ã“ã‚Œã¯ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®ã¿èµ·ã“ã‚‹ã®ã‹èª¿ã¹ã‚‹ãŸã‚ã«ã€unicodeã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã®ã¿ã‚’è¡Œã£ãŸ<code>&lt;img src=x onerror=alert(1)&gt;</code>ã‚’ãƒšãƒ¼ã‚¸ã«æ›¸ãè¾¼ã‚“ã§é–‹ã„ã¦ã¿ã‚‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="ni">&amp;#x003c;</span>img src<span class="ni">&amp;#x003d;</span>x onerror<span class="ni">&amp;#x003d;</span>alert<span class="ni">&amp;#x0028;</span>1<span class="ni">&amp;#x0029;&amp;#x003e;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>&lt;img src=x onerror=alert(1)&gt;</code>ã¨è¡¨ç¤ºã•ã‚Œã€ã‚¢ãƒ©ãƒ¼ãƒˆã¯ç™ºç«ã—ãªã„ã€‚</p>
<p>ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã¨åŒã˜JavaScriptã‚³ãƒ¼ãƒ‰ãŒscriptã‚¿ã‚°ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹å ´åˆã‚’è€ƒãˆã‚‹ã€‚</p>
<p>ä»¥ä¸‹ã®ã‚ˆã†ãªHTMLãŒã‚µãƒ¼ãƒãƒ¼ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="nx">x</span><span class="o">=</span><span class="s1">&#39;&amp;#x0027;&amp;#x003b;alert&amp;#x0028;1&amp;#x0029;&amp;#x003b;&amp;#x0027;&#39;</span><span class="p">;</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>ã“ã‚Œã‚’é–‹ã„ã¦ã‚‚ã‚¢ãƒ©ãƒ¼ãƒˆã¯å®Ÿè¡Œã•ã‚Œãªã„ã€‚</p>
<p>ã“ã‚Œã‚‰ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã®ã¿å®Ÿä½“å‚ç…§ãŒè©•ä¾¡ã•ã‚ŒãŸçŠ¶æ…‹ã§JavaScriptãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚</p>

    </div>
</div>

<div class="container">
    
    <nav class="flex container suggested">
        
        <a rel="prev" href="/post/2020-08-22-stack-and-calling-conventions/" title="Previous post (older)">
            <span>Previous</span>
            ã‚¹ã‚¿ãƒƒã‚¯ã¨å‘¼ã³å‡ºã—è¦ç´„
            </a>
        
        
        
        <a rel="next" href="/post/2021-07-21-rpo/" title="Next post (newer)">
            <span>Next</span>
            RPOã¨OpenRedirectã‚’ç”¨ã„ãŸXSS
            </a> 
        
    </nav>
    
</div>
 
<div class="container">
    
</div>

</main>


        </main>
        <footer class="footer flex">
    <section class="container">
        <nav class="footer-links">
            
            <a href="/index.xml">RSS</a>
            
        </nav>

        
    </section>
    <script defer src="/ts/features.c81551cd4dbef120af278f16966a41142c02be9ff5d6a669be09820fbf047456.js" 
    data-enable-footnotes="true"
    ></script>
</footer>

    </body>
</html>